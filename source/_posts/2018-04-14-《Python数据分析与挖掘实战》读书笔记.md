---
title: 《Python数据分析与挖掘实战》读书笔记
date: 2018-04-14 14:24:45
tags: [数据挖掘,读书笔记]
---

&emsp;&emsp;*本文是《Python数据分析与挖掘实战》的读书笔记。作者：张良均；王路；谭立云；苏剑林等，机械工业出版社2016年1月第1版。*

<!--more-->

# 第一章 数据挖掘基础

**以餐饮企业为例管理系统有：**
- 客户关系管理系统
- 前厅管理系统
- 后厨管理系统
- 财务管理系统
- 物资管理系统

**数据挖掘的建模基础过程：**
- 1.定义挖掘目标:任务理解；指标确定。
- 2.数据采集：建模抽样（相关/可靠/有效）；质量把控；实时采集。
- 3.数据整理：数据探索(是否达到了我们设想的要求，有没有规律趋势等)；数据清洗；数据变换。（预处理：数据筛选/变量转换/缺失值处理/坏数据处理/数据标准化/主成分分析/属性选择/数据规约等）
- 4.构建模型：模式发现；构建模型；验证模型。（判断属于哪类问题：分类/聚类/关联规则/时序模式或者智能推荐）
- 5.模型评价：设定评价标准；多模型对比；模型优化。
- 6.模型发布：模型部署；模型重构。

# 第二章 Python数据分析简介

python自带四种数据结构：列表（[],可以修改），元祖（（），不可修改）；字典（{},自定义键值对），集合（{}/set(),元素不重复且不支持索引）。
- Numpy:数组
- Scipy:科学计算；线代/积分/差值/拟合/傅立叶变换……
- Matplotlib:绘图可视
- Pandas：……（基石）
- StatsModels:着眼数据读取处理和探索（这个sk-learn也已经很优秀吧，回头再研究）
- Scikit-Learn:……机器学习……（基石）
- Keras:sk-learn不包含的人工神经网络，需要Theano搭建是他的简化。（深度后期还是优先考虑Tensorflow了）
- Genism:自然语言处理，包含了Word2Vec

# 第三章 数据探索

1.数据质量分析：
- 缺失值：字段和记录；
- 异常值：describe()统计，3sigma原则，箱型图分析，注意重视分析异常值出现的原因；
- 一致性分析：多数据源集成时没有一致更新。

2.数据特征分析：
- 分布分析：定量变量（频率分布分析：求极差->确定组距组数->分点->列表绘图）；定性变量（按变量类型分组）
- 对比分析：绝对数对比；相对数（比例数，完成度等）对比
- 统计量分析：集中趋势度量（均值，中位数，众数）；离中趋势度量（极差，标准差，变异系数）
- 周期性分析
- 贡献度分析(我这边3.6案例代码中的sort应该改sort_values,pyplot中文图例乱码回头再说)
- 相关性分析：散点图，计算相关系数data.corr()

# 第四章 数据预处理

1.数据清洗：
- 缺失处理：均值，中位数……拉格朗日，牛顿法插值；
- 异常处理：删除，缺失插值，前后插值，不处理。

2.数据集成

3.数据变换：数据规范化处理，方便挖掘算法
- 简单函数变换：平方，开方，对数，差分；
- 规范化：最小最大规范化(映射到[0,1])，零均值规范化(均值0标准差1)，小数定标规范化（移动小数位映射到[-1,1]）
- 连续属性离散化：等宽，等频，（一维）聚类。代码4-3聚类分析的算法我没有跑出来，对机器性能要求较高源数据才900多个此方法需注意尽量不使用，在自定义的作图函数cluster_plot中有一句有意思的代码：
{% codeblock lang:python %}
for j in range(0, k):
    #data[d==j]所有为j标签的点的data真实值做横坐标，[j for i in d[d==j]]对应的纵坐标都为j，d[d==j]该标签有多少个点就有多少个j做纵坐标
    plt.plot(data[d==j], [j for i in d[d==j]], 'o')
{% endcodeblock %}
- 属性构造：这个我觉得就要具体问题具体看了，为提高挖掘结果精度，构造新的属性。
- 小波变换：非平稳信号分解为表达不同层次、不同频带信息的数据序列->小波系数

4.数据规约

通过直接删除不相关的属性（维）来减少数据维度，提高挖掘效率。
- 属性规约：合并、逐步添加删除、决策树归纳、主成分分析
- 数值规约

5.Python主要数据预处理函数

interpolate(Scipy下插值库)、unique（drop_duplicate()）、isnull/notnull、PCA、random

# 第五章 挖掘建模

1.分类与预测：回归、决策树、人工神经网络、贝叶斯网络、支持向量机

- 逻辑回归：随机逻辑回归特征筛选RandomizedLogisticRegression然后get_support()，建立模型LogisticRegression
- 决策树：信息熵DTC(criterion='entropy'),在每个非叶子节点上的类别划分获得最大的增益
- 人工神经网络：Keras看起来也比较简单，Sequetial(),model.add(),compile(),fit()...
- 分类器评价：混淆矩阵：loc[i,j]=模式i被判断为模式j的百分率所以有正确率loc[i,i]...

2.聚类分析

- K-Means：预定聚成K类，选取各类中心，按距离分配所有对象；分配完后重新计算各类中心，再聚类，重复动作直到质心不再改变；sklearn.cluster Kmeans
- 聚类结果可视化——sklearn.manifold TSNE,也可以高维数据降维fit_transform()

3.关联分析

Apriori和FP-growth，现在的工作正好和这个相关，随后专文细聊

4.时序模式

金融交易常用的时间序列分析，随后细聊。ARIMA,StatsModels()

5.离群点检测

基于统计、邻近度、密度、聚类等

异常点这个问题我觉得还是要小心，从之前做的货期稳定性分析的一个项目中明显可以感觉到，每一个异常点还是要与业务进行详细的确认之后，商议处理的具体方案。

# 第六章 电力窃漏电用户自动识别

**目标：**
- 归纳出窃漏电用户的关键特征，构建窃漏电用户的识别模型。
- 利用实时监测的数据，调用窃漏电用户识别模型实现实时诊断。

**分析过程：**
- 数据抽取：某市208用户5年数据，同时包含每天是否窃漏电标识。
- 探索分析：分布来看非居民没有窃漏电情况；周期性看窃漏电用户会出现震荡下行。
- 数据预处理：清洗掉非居民和节假日；缺失值采用Lagrange插值处理；数据变换。
- 构建专家样本：根据定义的关键指标体系，处理选取样本形成专家库。

**窃漏电评价体系：**

在本案例数据变换部分，定义了表征窃漏电行为规律的指标体系：
- 电量趋势下降指标：计算前后各五日中电量趋势下降的总天数；
- 线损指标：前后五日的线损率变动率（这里明显会有未来函数，但想想窃漏电识别的实时性要求不高，就是使用模型的时候要注意最后几日的判断不可靠就好），漏窃电会导致当天的线损率上升，上升1%有漏窃电嫌疑；
- 告警类指标：漏窃相关报警次数总和。

**模型构建**

本案例中采用LM神经网络和CART决策树来构建了分类模型，随机选取20%测试，80%训练。
- LM神经网络模型（6-3）
- CART决策树模型（6-4）

**模型评价**

- 混淆矩阵评价
- 绘制ROC曲线

# 第七章 航空公司客户价值分析

**目标：**
- 借助航空公司的客户数据对客户进行分类。
- 分类客户进行特征分析，比较不同客户的价值。
- 制定差异化的营销策略。

**客户价值识别模型指标：**

- 广泛应用的客户价值RFM模型：消费时间间隔（Recency）、消费频率（Frequency）、消费金额（Monetary）。每个维度按高低分就会产生8个区域对应着不同的策略。
- 本案例扩展的LRFMC模型：Lenth?(入会时长几个月)、Recent?(最近乘机是几月前)、Frequency(频率)、Miles？(飞行的总里程)、cost？(折扣系数均值)

**模型构建**

- 对五个指标做标准差标准化；
- 调用K-means来实现聚类分群，K=5这里需要由业务来理解和敲定。

# 第八章 中医证型关联规则挖掘

**目标：**
- 挖掘症状与中医证型之间的关联关系。
- 挖掘潜在的证素。

**模型构建**
- 本案例使用了问卷分析的方式，以及数据离散化的方法（8-1）。离散化是为了使用apriori算法。
- apriori，挖掘频繁项关联关系。输出support和confidence。

# 第九章 基于水色图像的水质评价

**目标：**
- 利用图像处理急速，通过水色图像实现水质自动评价。

**模型构建**
- 特征提取采用的是一、二、三阶颜色矩，分别可以反映到图像的明暗程度、颜色分布范围以及颜色分布对称性。
- 模型调用了svm支持向量机

# 第十章 家用电器用户行为分析与事件识别

**目标：**
- 根据热水器采集到的数据，划分一次完整的用水事件。
- 在划分好的一次完整用水事件中识别出洗浴。

**模型构建**
- 对历史用水数据进行选择性抽取，构建专家样本。
- 以没有水流为界划分用水事件，针对没有水流的时间阈值进行优化设计（考虑用户的停顿习惯）。
- 筛选短暂用水的事件，包括时长和水量等条件。
- 采用多层神经网络建立识别模型。

# 第十一章 应用系统负载分析与磁盘容量预测

**目标：**
- 预测服务器磁盘已使用空间大小。
- 设置不同预警等级，为管理员提供定制化预警提示。

**模型构建**
- 采用时间序列分析，预测服务器磁盘使用情况。
- 平稳性检验，diff ADF。
- ARIMA(0,1,1)。

# 第十二章 电子商务网站用户行为分析及服务推荐

**目标：**
- 按地域研究用户访问时间、内容和访问次数等，了解用户的访问行为关心的内容。
- 借助用户访问记录，发现用户习惯，进行推荐。

**模型构建**
- 访问数据库sqlalchemy。
- 用jaccard相似公式计算两两物品的相似度矩阵（先转换为了0-1矩阵）。
- 按相似度计算用户兴趣度，获得推荐结果。

# 第十三章 财政收入影响因素分析及预测模型

**目标：**
- 梳理影响地方财政收入的关键特征、分析、识别构建模型，预测财政收入。

**模型构建**
- 灰色预测与神经网络组合模型。
- Adaptive-Lasso及逆行变量选择，然后根据识别的因素建立神经网络。

# 第十四章 基于基站定位数据的商圈分析

**目标：**
- 用用户历史定位数据对基站进行分群。
- 不同商圈分群的特征分析没比较商圈类别价值，选择合适的促销活动。

**模型构建**
- 使用离差标准化来消除数量级使各属性差异较大。
- 使用层次聚类，画出谱系聚类图，据此确定聚类数量k=3（这里没有说聚类完毕应该是没有验证稳定吧）。层次聚类AggiomerativeClustering,并分别作图。

# 第十五章 电商产品评论数据情感分析

**目标：**
- 用户评论挖掘。
- 分析用户情感倾向，提炼热水器卖点。

**模型构建**
- 用八爪鱼采集器爬去京东上美的热水器评论数据。
- 文本去重，jieba分词，LDA主题分析，得到好评和差评的潜在主题并作出评价建议。

# 总结

&emsp;&emsp;基础篇就不多说了，从研读第六章起我感觉，这本书在提供框架思路上是很不错的，但是很多地方讲的并不是特别细致，这也是当然的，其实每个案例搞清楚了背后的技术细节都能展开成一本书，而本书更多的是展示mining的各种可解决的问题和处理方法，当做一个指导备查提供思路的手册非常好。

&emsp;&emsp;问题与关键方法小结：
- 分类识别问题：第六章（LM神经网络，CART决策树），第九章（svm），第十章（多层神经网络），第十三章（Adaptive-Lasso，该方法可以自动剔除共线性）
- 聚类问题：第七章（K-means），第十四章（层次聚类，谱系聚类图等可视）
- 关联分析：第八章（Apriori），第十二章（相似度推荐）
- 时间序列：第十一章（ARIMA）
- 文本挖掘NLP：第十五章（jieba）

{% asset_img 封面.png %}